<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>openMIC - @ViewBag.Title</title>
    <meta name="application-name" content="openMIC" />
    <meta name="description" content="open Meter Information Collection System" />
    <meta name="keywords" content="open source, utility, software, meter, interrogation" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <link href="Content/bootstrap.min.css" rel="stylesheet">
    <link href="Content/bootstrap-theme.min.css" rel="stylesheet">
    <link href="Content/Site.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="Images/Icons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="Images/Icons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="Images/Icons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="Images/Icons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="Images/Icons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="Images/Icons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="Images/Icons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="Images/Icons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="Images/Icons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="Images/Icons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="Images/Icons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="Images/Icons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="Images/Icons/favicon-128.png" sizes="128x128" />
    <link rel="shortcut icon" href="Images/Icons/favicon.ico" />
    <meta name="msapplication-TileColor" content="#AABBAA" />
    <meta name="msapplication-TileImage" content="Images/Icons/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="Images/Icons/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="Images/Icons/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="Images/Icons/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="Images/Icons/mstile-310x310.png" />
    <script src="Scripts/jquery-2.1.4.min.js"></script>
    <script src="Scripts/js.cookie.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script src="Scripts/ie10-viewport-bug-workaround.js"></script>
    <script src="Scripts/jquery.signalR-2.2.0.min.js"></script>
    <script src="Scripts/knockout-3.4.0.js"></script>
    <script src="Scripts/knockout.mapping.js"></script>
    <script src="Scripts/formatDate.js"></script>
    <script src="signalr/hubs"></script>
</head>
<body role="document">
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="https://www.gridprotectionalliance.org/" target="_blank">
                    <img alt="Grid Protection Alliance" src="Images/gpa-smalllock.png" style="float: left">&nbsp;&nbsp;
                    <span style="font-size: larger">openMIC</span>
                </a>
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li @Raw(ViewBag.Title == "Home" ? "class=\"active\"" : "")><a href="Index.cshtml">Home</a></li>
                    <li @Raw(ViewBag.Title == "Devices" ? "class=\"active\"" : "")><a href="Devices.cshtml">Devices</a></li>
                    <li @Raw(ViewBag.Title == "Status" ? "class=\"active\"" : "")><a href="Status.cshtml">Status</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Meta-data <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="Vendors.cshtml">Vendors</a></li>
                            <li><a href="VendorDevices.cshtml">Vendor Devices</a></li>
                            @*
                                <li role="separator" class="divider"></li>
                                <li class="dropdown-header">Nav header</li>
                                <li><a href="#">Separated link</a></li>
                                <li><a href="#">One more separated link</a></li>
                            *@
                        </ul>
                    </li>
                </ul>
                <p class="nav navbar-text navbar-right" style="padding-right: 20px">
                    <button type="button" class="btn btn-sm btn-info disabled">Log Out</button>
                </p>
            </div><!--/.nav-collapse -->
        </div>
    </div>
    <script type="text/javascript">
        // Declare proxy references to the SignalR hubs
        var dataHub = $.connection.dataHub.server;
        var dataHubClient = $.connection.dataHub.client;
        var serviceHub = $.connection.serviceHub.server;
        var serviceHubClient = $.connection.serviceHub.client;
        var hubIsConnecting = false;
        var hubIsConnected = false;

        function hideErrorMessage() {
            $('#error-msg-block').hide();
        }

        function hideInfoMessage() {
            $('#info-msg-block').hide();
        }

        function showErrorMessage(message) {
            $('#error-msg-text').html(message);
            $('#error-msg-block').show();
        }

        function showInfoMessage(message) {
            $('#info-msg-text').html(message);
            $('#info-msg-block').show();
        }
    </script>
    <div class="container theme-showcase" role="main">
        <div class="page-header">
            <div class="alert alert-info fade in" role="alert" id="info-msg-block" style="display:none">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
                <span class="sr-only">Info</span>
                <strong>Info:</strong>&nbsp;<span id="info-msg-text"></span>
            </div>
            <div class="alert alert-danger fade in" role="alert" id="error-msg-block" style="display:none">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Error</span>
                <strong>Error:</strong>&nbsp;<span id="error-msg-text"></span>
            </div>
            <h3>@ViewBag.Title</h3>
        </div>
        @RenderBody()
    </div>
    <script type="text/javascript">
        function hubConnected() {
            hubIsConnecting = false;
            hubIsConnected = true;

            hideErrorMessage();

            if (typeof onHubConnected == 'function')
                onHubConnected();
        }

        $(function () {
            $(".page-header").css('margin-bottom', '-5px');

            $.connection.hub.reconnecting(function () {
                hubIsConnecting = true;
            });

            $.connection.hub.reconnected(function () {
                hubConnected();
            });

            $.connection.hub.disconnected(function () {
                hubIsConnected = false;

                if (hubIsConnecting)
                    showErrorMessage("Disconnected from server");

                setTimeout(function () {
                    $.connection.hub.start().done(function () {
                        hubConnected();
                    });
                }, 5000); // Restart connection after 5 seconds.
            });

            // Start the connection
            $.connection.hub.start().done(function () {
                hubConnected();
            });
        });
    </script>
</body>
</html>